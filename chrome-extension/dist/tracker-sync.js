"use strict";(()=>{var e="[FT-sync]",n="filament-tracker-stock";console.log(e,"Content script loaded on",window.location.href);function s(){let r=localStorage.getItem(n);if(!r){console.log(e,`No "${n}" key in localStorage \u2014 nothing to sync`);return}console.log(e,`Found stock data (${r.length} chars), parsing...`);try{let o=JSON.parse(r);if(o.version!==2||!Array.isArray(o.entries)){console.warn(e,"Stock data has wrong shape \u2014 version:",o.version);return}console.log(e,`Sending STOCK_SYNC with ${o.entries.length} entries to service worker`);let t={type:"STOCK_SYNC",stockData:o};chrome.runtime.sendMessage(t,a=>{chrome.runtime.lastError?console.error(e,"sendMessage failed:",chrome.runtime.lastError.message):console.log(e,"Service worker responded:",a)})}catch(o){console.error(e,"Failed to parse stock data:",o)}}s();window.addEventListener("storage",r=>{r.key===n&&(console.log(e,"localStorage changed, re-syncing..."),s())});})();
